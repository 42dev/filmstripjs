/*
	Filmstrip.coffee
	Created by the 42 developer team
	Version 1.0 4/16/13
	
	Requirements: jQuery
*/
var __bind=function(e,t){return function(){return e.apply(t,arguments)}};window.Filmstrip=function(){function e(e){this.generate_images=__bind(this.generate_images,this);this.doAnimation=__bind(this.doAnimation,this);this.playTo=__bind(this.playTo,this);this.playFromTo=__bind(this.playFromTo,this);this.jumpTo=__bind(this.jumpTo,this);this.pause=__bind(this.pause,this);this.play=__bind(this.play,this);this.currFrame=0;this.animator_timeout=false;this.totalFrames=0;this.frames=[];this.options={image_container_selector:"#container",frame_urls:[],framerate:42,setup_cbfn:false,pre_animation_cbfn:false,post_animation_cbfn:false,pre_showFrame_cbfn:false,post_showFrame_cbfn:false};$.extend(this.options,e);this.$container=$(this.options.image_container_selector).empty();this.generate_images();if(this.frames.length>0){this.frames[0].show()}this.totalFrames=this.frames.length;if(typeof this.options.setup_cbfn==="function"){this.options.setup_cbfn()}}e.prototype.play=function(){return this.playTo(this.totalFrames-1)};e.prototype.pause=function(){window.clearInterval(this.animator_timeout);return this.animator_timeout=false};e.prototype.jumpTo=function(e){e=this.bound_frame_index(e);window.clearInterval(this.animator_timeout);this.animator_timeout=false;if(e===void 0){return}this.frames[this.currFrame].hide();this.frames[e].show();return this.currFrame=e};e.prototype.playFromTo=function(e,t){this.currFrame=this.bound_frame_index(e);return this.playTo(this.bound_frame_index(t))};e.prototype.playTo=function(e){var t=this;window.clearInterval(this.animator_timeout);this.animator_timeout=false;e=this.bound_frame_index(e);if(e===void 0){return}if(typeof this.options.pre_animation_cbfn==="function"){this.options.pre_animation_cbfn(this.currFrame)}return this.animator_timeout=setInterval(function(){return t.doAnimation(e)},1/(this.options.framerate/1e3))};e.prototype.doAnimation=function(e){if(typeof this.options.pre_showFrame_cbfn==="function"){this.options.pre_showFrame_cbfn(this.currFrame)}if(this.currFrame!==e){this.frames[this.currFrame].hide();if(e>this.currFrame){this.currFrame++}else{this.currFrame--}this.frames[this.currFrame].show();if(typeof this.options.post_showFrame_cbfn==="function"){return this.options.post_showFrame_cbfn(this.currFrame)}}else{window.clearInterval(this.animator_timeout);this.animator_timeout=false;if(typeof this.options.post_animation_cbfn==="function"){return this.options.post_animation_cbfn(this.currFrame)}}};e.prototype.generate_images=function(){var e,t,n,r,i,s;i=this.options.frame_urls;s=[];for(n=0,r=i.length;n<r;n++){t=i[n];e=$('<img src="'+t+'" style="display:none;" />');this.$container.append(e);s.push(this.frames.push(e))}return s};e.prototype.bound_frame_index=function(e){if(this.totalFrames===0){return void 0}return Math.max(Math.min(e,this.totalFrames-1),0)};return e}()